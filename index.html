<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>AndrewMoa的知识分享</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="AndrewMoa的知识分享">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="AndrewMoa的知识分享">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Andrew Moa">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="AndrewMoa的知识分享" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">AndrewMoa的知识分享</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Linux/Ubuntu24.04安装Ansys2025R1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Linux/Ubuntu24.04%E5%AE%89%E8%A3%85Ansys2025R1/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:29.926Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Linux/Ubuntu24.04%E5%AE%89%E8%A3%85Ansys2025R1/">Ubuntu24.04安装Ansys2025R1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>25&#x2F;03&#x2F;2025</p>
<hr>
<p>[TOC]</p>
<hr>
<h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><p>全部安装需要161GB磁盘空间，请确保磁盘剩余可用空间满足需求，可以根据自己需求选择安装内容。<br><img src="/../../images/e8b6a55779447694ef28a8a9560f2bab.png" alt="e8b6a55779447694ef28a8a9560f2bab.png"><br><img src="/../../images/3f912a7795844465627dc878eb409e95.png" alt="3f912a7795844465627dc878eb409e95.png"><br>安装过程中至少需要8GB内存，推荐内存16~32GB。</p>
<p>安装过程中的依赖工具：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install libnsl2 libpcre3 lsb-* ldap-utils libunistring5 xfonts-100dpi xfonts-75dpi</span><br></pre></td></tr></table></figure>

<p>其他运行时的依赖工具安装，请查询官方文档。</p>
<p>Ansys2025R1安装文件中包含9个<code>.iso</code>安装文件，用以下命令挂载<code>.iso</code>文件到指定路径：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> <span class="variable">$&#123;HOME&#125;</span>/ISO/1</span><br><span class="line"><span class="built_in">sudo</span> mount <span class="variable">$&#123;HOME&#125;</span>/Share/Ansys/ANSYS2025R1_LINX64_DISK1.iso <span class="variable">$&#123;HOME&#125;</span>/ISO/1 -o loop</span><br></pre></td></tr></table></figure>
<p>同样的办法，将剩下的安装包分别挂载至其他文件夹。</p>
<h2 id="2-安装许可证服务器"><a href="#2-安装许可证服务器" class="headerlink" title="2. 安装许可证服务器"></a>2. 安装许可证服务器</h2><h3 id="2-1-安装Ansys-License-Manager"><a href="#2-1-安装Ansys-License-Manager" class="headerlink" title="2.1 安装Ansys License Manager"></a>2.1 安装Ansys License Manager</h3><p>由于Ansys安装需要用到图形界面，因此需要先通过远程连接进入Ubuntu桌面系统。</p>
<p>进入第一个安装包的挂载点，运行安装程序：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$&#123;HOME&#125;</span>/ISO/1</span><br><span class="line"><span class="built_in">sudo</span> ./INSTALL <span class="comment"># 由于需要以服务形式运行，建议以管理员用户权限运行安装程序</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/598ba0142449e130e1d6680aef25e2db.png" alt="598ba0142449e130e1d6680aef25e2db.png"></p>
<p>许可证安装路径选择：<code>/opt/ansys_inc</code>：<br><img src="/../../images/5a06611a2b8026902f761f7ff6953b86.png" alt="5a06611a2b8026902f761f7ff6953b86.png"><br>安装完成后退出安装程序。</p>
<p>确认Ansys许可证服务器的守护进程是否在运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -eaf | grep ansyslmd</span><br></pre></td></tr></table></figure>

<p>如果ansyslmd进程在运行，kill掉它：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -s 9 [PID] <span class="comment"># [PID]填写ansyslmd进程的PID</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-配置许可证服务器"><a href="#2-2-配置许可证服务器" class="headerlink" title="2.2 配置许可证服务器"></a>2.2 配置许可证服务器</h3><p>我们需要将<code>ansys.2025r1.linx64-ssq.tar.gz</code>压缩包中的<code>/shared_files</code>文件夹下的文件解压到安装目录下并覆盖：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar xvzf ansys.2025r1.linx64-ssq.tar.gz</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> -r shared_files /opt/ansys_inc/</span><br></pre></td></tr></table></figure>

<p>接下来配置许可证服务，以下命令运行许可证配置程序：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> /opt/ansys_inc/shared_files/licensing/init_ansyslm_tomcat start</span><br></pre></td></tr></table></figure>

<p>然后用浏览器打开该地址：<code>http://localhost:1084/ANSYSLMCenter.html</code>，定位到<code>Get System Hostid information</code>栏目，找到<code>HOSTID</code>，把它复制下来后面会用到：<br><img src="/../../images/a52950f2db9ae12884303cbf17f8bdc2.png" alt="a52950f2db9ae12884303cbf17f8bdc2.png"></p>
<p>打开<code>license_2024.12.15.txt</code>文件，在开头的<code>SERVER localhost XXXXXXXXXXXX 1055</code>这一行中将<code>XXXXXXXXXXXX</code>替换为上面复制下来的<code>HOSTID</code>，保存文件。<br><img src="/../../images/98784654bd0673c67c268b30c410841d.png" alt="98784654bd0673c67c268b30c410841d.png"></p>
<p>定位到<code>Add a License File</code>栏目，载入刚刚编辑过的<code>license_2024.12.15.txt</code>文件。<br><img src="/../../images/8b20a3edf84fd2d7ed3014bb482ebaa3.png" alt="8b20a3edf84fd2d7ed3014bb482ebaa3.png"></p>
<p>这里出现了一个问题，提示<code>lmgrd</code>找不到，无法启动服务器守护进程，运行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> /opt/ansys_inc/shared_files/licensing/linx64/update/lmgrd /opt/ansys_inc/shared_files/licensing/linx64/lmgrd</span><br></pre></td></tr></table></figure>

<p>再次载入文件即可：<br><img src="/../../images/3d393bbce991d531ef2829ec57b3f0d2.png" alt="3d393bbce991d531ef2829ec57b3f0d2.png"></p>
<p>定位到<code>View Status/Start/Stop License Manager</code>栏目，确认服务器运行状态：<br><img src="/../../images/fc01fe3a22a3f809c25540c512c61df0.png" alt="fc01fe3a22a3f809c25540c512c61df0.png"></p>
<p>退出浏览器并关闭许可证配置程序，确认守护进程是否在运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> /opt/ansys_inc/shared_files/licensing/init_ansyslm_tomcat stop</span><br><span class="line">ps -eaf | grep ansyslmd</span><br></pre></td></tr></table></figure>
<p><img src="/../../images/edac3b8a6905bbabd6bbe9ab46101f0f.png" alt="edac3b8a6905bbabd6bbe9ab46101f0f.png"></p>
<p>如果许可证服务器和主程序分别安装在不同机器上，需要在防火墙中开启许可证服务器的1055端口：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ufw allow from any to any port 1055 proto tcp</span><br></pre></td></tr></table></figure>

<h3 id="2-3-添加自定义服务"><a href="#2-3-添加自定义服务" class="headerlink" title="2.3 添加自定义服务"></a>2.3 添加自定义服务</h3><p>完成以上设置，当重启服务器之后，系统不会自动启动守护进程，需要通过以下命令启动ansyslmd：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> /opt/ansys_inc/shared_files/licensing/start_ansyslmd</span><br></pre></td></tr></table></figure>

<p>为了防止服务器断电重启之后因许可证问题导致无法计算，下面通过systemd添加自定义服务，实现开机自动启动守护进程。以下命令新建ansyslmd服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">touch</span> /usr/lib/systemd/system/ansyslmd.service</span><br><span class="line"><span class="built_in">sudo</span> vim /usr/lib/systemd/system/ansyslmd.service</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 754 /usr/lib/systemd/system/ansyslmd.service</span><br></pre></td></tr></table></figure>

<p>添加如下内容并保存退出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Ansys License Deamon</span><br><span class="line">After=ansyslmd.service</span><br><span class="line">  </span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">User=root</span><br><span class="line">Group=root</span><br><span class="line">ExecStart=/opt/ansys_inc/shared_files/licensing/start_ansyslmd</span><br><span class="line">ExecReload=</span><br><span class="line">ExecStop=/opt/ansys_inc/shared_files/licensing/stop_ansyslmd</span><br><span class="line">  </span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>通过以下命令启动服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> ansyslmd</span><br><span class="line"><span class="built_in">sudo</span> systemctl start ansyslmd</span><br></pre></td></tr></table></figure>

<p>查看服务状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl status ansyslmd</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/936bafa551b8e5f366e60560bc7a3cb1.png" alt="936bafa551b8e5f366e60560bc7a3cb1.png"><br>服务启动成功，安装完毕后可以重启验证下。</p>
<h2 id="3-安装主程序"><a href="#3-安装主程序" class="headerlink" title="3. 安装主程序"></a>3. 安装主程序</h2><p>安装主程序同样需要进入Ubuntu桌面系统。</p>
<p>进入第一个安装包的挂载点，运行安装程序：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$&#123;HOME&#125;</span>/ISO/1</span><br><span class="line"><span class="built_in">sudo</span> ./INSTALL <span class="comment"># 用root权限安装</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/6933ca38adf2f53214ee6da37be02675.png" alt="6933ca38adf2f53214ee6da37be02675.png"></p>
<p>求解同样选择安装在：<code>/opt/ansys_inc</code><br><img src="/../../images/93a9af6a6829b4c21c211ed56a9089a2.png" alt="93a9af6a6829b4c21c211ed56a9089a2.png"></p>
<p>根据自己需要选择安装哪些内容：<br><img src="/../../images/921717f7b3c0f69710ca2d0de4f8a702.png" alt="921717f7b3c0f69710ca2d0de4f8a702.png"></p>
<p>配置CAD几何图形接口，本机没安装CAD软件，选择跳过：<br><img src="/../../images/3905fc228e5b13ede8a3389f6997b76f.png" alt="3905fc228e5b13ede8a3389f6997b76f.png"></p>
<p>根据前面选择安装内容的不同，后面会询问一堆配置文件路径，根据自己需要设置吧，没有就无脑Next。<br><img src="/../../images/1ae7bc0a6a670019f24a6b43a6a45e7b.png" alt="1ae7bc0a6a670019f24a6b43a6a45e7b.png"></p>
<p>选择是否创建桌面快捷方式，选上吧，兴许有用呢。<br><img src="/../../images/40ec3516e05c8562ad9e52ed6703e3ef.png" alt="40ec3516e05c8562ad9e52ed6703e3ef.png"></p>
<p>确认安装内容，点击Next开始复制文件：<br><img src="/../../images/bdaa34603562269aeb94f1634682c3e5.png" alt="bdaa34603562269aeb94f1634682c3e5.png"></p>
<p>可以查看安装进度，安装过程中会询问载入其他<code>.iso</code>文件挂载路径。<br><img src="/../../images/6e6129bc46d805ef3d32b5269fdddbf0.png" alt="6e6129bc46d805ef3d32b5269fdddbf0.png"></p>
<p>安装完成，提示有一些报错，不管它，退出。<br><img src="/../../images/8329e891f49681100884f8cd734a3685.png" alt="8329e891f49681100884f8cd734a3685.png"></p>
<p>接下来将<code>ansys.2025r1.linx64-ssq.tar.gz</code>压缩包中的<code>v251</code>文件夹下的文件解压到安装目录下并覆盖：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar xvzf ansys.2025r1.linx64-ssq.tar.gz</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> -r v251 /opt/ansys_inc/</span><br></pre></td></tr></table></figure>

<p>主程序安装完成，卸载<code>.iso</code>文件的挂载点：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> umount <span class="variable">$&#123;HOME&#125;</span>/ISO/1</span><br></pre></td></tr></table></figure>
<p>剩余挂载点按相同方式卸载。</p>
<h2 id="4-配置主程序许可证"><a href="#4-配置主程序许可证" class="headerlink" title="4. 配置主程序许可证"></a>4. 配置主程序许可证</h2><p>安装完主程序之后，需要给主程序配置许可证，有两种方法。</p>
<h3 id="4-1-方法1→配置环境变量"><a href="#4-1-方法1→配置环境变量" class="headerlink" title="4.1 方法1→配置环境变量"></a>4.1 方法1→配置环境变量</h3><p>在<code>$&#123;HOME&#125;/opt/</code>中创建并编辑环境变量文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> <span class="variable">$&#123;HOME&#125;</span>/opt/ansys2025r1.<span class="built_in">env</span></span><br><span class="line"><span class="built_in">chmod</span> +x <span class="variable">$&#123;HOME&#125;</span>/opt/ansys2025r1.<span class="built_in">env</span></span><br><span class="line">vim <span class="variable">$&#123;HOME&#125;</span>/opt/ansys2025r1.<span class="built_in">env</span></span><br></pre></td></tr></table></figure>

<p>加入以下内容，保存退出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ANSYSLMD_LICENSE_FILE=1055@localhost</span><br></pre></td></tr></table></figure>

<p>后续可以通过以下命令载入环境变量。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> <span class="variable">$&#123;HOME&#125;</span>/opt/ansys2025r1.<span class="built_in">env</span></span><br></pre></td></tr></table></figure>
<p>可以把上面的命令行加入到<code>$&#123;HOME&#125;/.bashrc</code>文件当中，这样每次登录都会自动载入环境变量。</p>
<h3 id="4-2-方法2→Ansys-Licensing-Settings"><a href="#4-2-方法2→Ansys-Licensing-Settings" class="headerlink" title="4.2 方法2→Ansys Licensing Settings"></a>4.2 方法2→Ansys Licensing Settings</h3><p>运行以下命令启动<code>Licensing Settings</code>程序：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ansys_inc/v251/licensingclient/linx64/LicensingSettings</span><br></pre></td></tr></table></figure>

<p>按步骤进行以下设置：</p>
<ol>
<li>将配置文件等级从Installion改为User</li>
<li>将状态设置为Enable</li>
<li>端口号填写1055</li>
<li>Server1地址填写localhost</li>
<li>点击Test按钮测试</li>
<li>点击Save保存配置</li>
</ol>
<p><img src="/../../images/4a20e58eeea7df3348c81b7cd2b1dd5c.png" alt="4a20e58eeea7df3348c81b7cd2b1dd5c.png"><br>保存退出，完成许可证配置。</p>
<h2 id="5-启动主程序"><a href="#5-启动主程序" class="headerlink" title="5. 启动主程序"></a>5. 启动主程序</h2><p>配置完许可证之后，通过以下命令启动<code>Workbench</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ansys_inc/v251/Framework/bin/Linux64/runwb2</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/3294556c73209acc5799dc0203469459.png" alt="3294556c73209acc5799dc0203469459.png"></p>
<p>类似的，一些关键主程序的入口参考如下：</p>
<table>
<thead>
<tr>
<th>Application</th>
<th>How to Launch</th>
</tr>
</thead>
<tbody><tr>
<td>ACP</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;ACP&#x2F;ACP.sh</td>
</tr>
<tr>
<td>CFD-Post</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;cfdpost</td>
</tr>
<tr>
<td>CFX</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;CFX&#x2F;bin&#x2F;cfx5<sup>(注)</td>
</tr>
<tr>
<td>FLUENT</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;fluent&#x2F;bin&#x2F;fluent</td>
</tr>
<tr>
<td>ICEM CFD</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;icemcfd&#x2F;icemcfd</td>
</tr>
<tr>
<td>ICEPAK</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;icepak&#x2F;icepak</td>
</tr>
<tr>
<td>Motion</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;Motion&#x2F;solver&#x2F;rundfs.sh</td>
</tr>
<tr>
<td>Polyflow Classic</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;polyflow&#x2F;bin&#x2F;polyflow</td>
</tr>
<tr>
<td>TurboGrid</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;TurboGrid&#x2F;bin&#x2F;cfxtg</td>
</tr>
<tr>
<td>Sherlock</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;sherlock&#x2F;runSherlock</td>
</tr>
<tr>
<td>Workbench</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;Framework&#x2F;bin&#x2F;Linux64&#x2F;runwb2</td>
</tr>
<tr>
<td>Electronics</td>
<td>&#x2F;ansys_inc&#x2F;v251&#x2F;AnsysEM&#x2F;ansysedt</td>
</tr>
</tbody></table>
<p><sup>(注): cfx5可以替换成 cfx5launch、cfx5pre、cfx5solve或cfx5post.，分别对应不同的功能模块。</p>
<p>至此，Ansys安装完毕。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Linux/Ubuntu24.04%E5%AE%89%E8%A3%85Ansys2025R1/" data-id="cm8orjgqi000bpw093e2acuov" data-title="Ubuntu24.04安装Ansys2025R1" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux/Ubuntu24.04搭建Samba服务器" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Linux/Ubuntu24.04%E6%90%AD%E5%BB%BASamba%E6%9C%8D%E5%8A%A1%E5%99%A8/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:29.921Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Linux/Ubuntu24.04%E6%90%AD%E5%BB%BASamba%E6%9C%8D%E5%8A%A1%E5%99%A8/">Ubuntu24.04搭建Samba服务器</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>24&#x2F;03&#x2F;2025</p>
<hr>
<p>由于Ubuntu运行在虚拟机中，通过Ubuntu挂载Windows共享文件夹，在挂载点中运行某些CAE软件会出现计算报错。考虑将Ubuntu文件夹共享给Windows，因此需要在Ubuntu系统上搭建Samba服务器。</p>
<p>首先在Ubuntu上安装samba软件包：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install samba -y</span><br></pre></td></tr></table></figure>

<p>创建共享文件夹：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> <span class="variable">$&#123;HOME&#125;</span>/LinuxShare</span><br></pre></td></tr></table></figure>

<p>编辑Samba配置文件<code>/etc/samba/smb.conf</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/samba/smb.conf</span><br></pre></td></tr></table></figure>

<p>在文件末尾增加以下内容，保存退出：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[Ubuntu_Share] # 在客户端上显示的共享文件夹的名称</span><br><span class="line">    comment = Samba	# 注释，展示给用户看的</span><br><span class="line">    path = /home/***/LinuxShare	# 共享文件夹的本地路径，填写绝对路径</span><br><span class="line">    public = yes	# 是否允许匿名用户访问</span><br><span class="line">    writable = yes	# 是否允许用户编辑</span><br><span class="line">    available = yes	# 是否可用</span><br><span class="line">    browseable = yes	# 是否可以在网络上浏览</span><br><span class="line">    valid users = user	# 填写Ubuntu登录用户名	</span><br></pre></td></tr></table></figure>

<p>给Samba用户设置密码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> smbpasswd -a user</span><br></pre></td></tr></table></figure>

<p>启动Samba服务的守护进程：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> smbd</span><br><span class="line"><span class="built_in">sudo</span> systemctl start smbd</span><br></pre></td></tr></table></figure>

<p>查询Samba服务状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl status smbd</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/43d6c0a3f978558be05ab8832d33eff8.png" alt="43d6c0a3f978558be05ab8832d33eff8.png"><br>服务状态：<code>Active: active (running)</code>，正常运行。</p>
<p>更新Samba配置文件<code>/etc/samba/smb.conf</code>之后通过以下命令刷新：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> service smbd restart </span><br></pre></td></tr></table></figure>

<p>添加防火墙规则：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ufw allow samba</span><br></pre></td></tr></table></figure>

<p>配置完成，可以在Windows端访问该共享文件夹，这部分就省略了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Linux/Ubuntu24.04%E6%90%AD%E5%BB%BASamba%E6%9C%8D%E5%8A%A1%E5%99%A8/" data-id="cm8orjgqi000cpw09hek1bd8w" data-title="Ubuntu24.04搭建Samba服务器" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux/Ubuntu安装SIMULIA2024" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Linux/Ubuntu%E5%AE%89%E8%A3%85SIMULIA2024/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:29.918Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Linux/Ubuntu%E5%AE%89%E8%A3%85SIMULIA2024/">Ubuntu安装SIMULIA2024</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>21&#x2F;03&#x2F;2025</p>
<hr>
<p>[TOC]</p>
<hr>
<p>为什么选择SIMULIA？首先是Abaqus功能强大，绝大多数结构问题都能求解。其次流固耦合方便，STAR-CCM+自带案例就手把手你怎么和Abaqus双向耦合。再次是过往经历的惯性，毕竟主机厂Abaqus用得可不少，不缺案例和资源。</p>
<h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><p>首先安装开发环境和一些必要的软件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update <span class="comment"># 更新软件源</span></span><br><span class="line"><span class="built_in">sudo</span> apt upgrade <span class="comment"># 更新本地安装的软件</span></span><br><span class="line"><span class="built_in">sudo</span> apt install build-essential <span class="comment"># 安装开发环境</span></span><br><span class="line"><span class="built_in">sudo</span> apt install csh tcsh ksh gcc g++ gfortran libstdc++5 build-essential make libjpeg62 libmotif-dev</span><br></pre></td></tr></table></figure>

<p>解压安装包：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> iso <span class="comment"># 新建一个iso文件夹，用于存放解压出来的文件</span></span><br><span class="line">tar xvzf DS.SIMULIA.SUITE.2024.LINX64.tar.gz -C ./iso <span class="comment"># 解压到iso文件夹中</span></span><br></pre></td></tr></table></figure>

<h2 id="2-安装过程"><a href="#2-安装过程" class="headerlink" title="2. 安装过程"></a>2. 安装过程</h2><h3 id="2-1-启动安装程序"><a href="#2-1-启动安装程序" class="headerlink" title="2.1 启动安装程序"></a>2.1 启动安装程序</h3><p>首先定义环境变量，不然无法启动安装程序：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以把下面的内容加到$&#123;HOME&#125;/.bashrc里，然后重新启动终端</span></span><br><span class="line"><span class="built_in">export</span> DSYAuthOS_`lsb_release -si`=1</span><br><span class="line"><span class="built_in">export</span> DSY_Force_OS=linux_a64</span><br><span class="line"><span class="built_in">export</span> NOLICENSECHECK=<span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>进入<code>/iso/1</code>文件夹，运行安装程序。启动图形化界面在终端运行<code>./StartGUI.sh</code>，类似Windows下的安装方式，跟着向导一步步安装即可。</p>
<p>这里选择文本界面：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./StartTUI.sh <span class="comment"># 启动文本界面安装向导</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/7222cbf4b6f8545b9766ce654edf28ba.png" alt="7222cbf4b6f8545b9766ce654edf28ba.png"><br><code>Enter</code>下一步。</p>
<p><img src="/../../images/32a37d1807765cbc529f11c58e35ea12.png" alt="32a37d1807765cbc529f11c58e35ea12.png"><br>记得一定要选<code>4</code>，也就是<code>FLEXnet License Server</code>。输入<code>4</code>，然后<code>Enter</code>继续。</p>
<p><img src="/../../images/e29968284f99250e82746af3a935d704.png" alt="e29968284f99250e82746af3a935d704.png"><br>确认安装内容，<code>Enter</code>开始启动相关安装程序。</p>
<h3 id="2-2-安装许可证服务器"><a href="#2-2-安装许可证服务器" class="headerlink" title="2.2 安装许可证服务器"></a>2.2 安装许可证服务器</h3><p><img src="/../../images/2b46aa33180c36f27a537a1ab8418f3a.png" alt="2b46aa33180c36f27a537a1ab8418f3a.png"><br>选择<code>P</code>，然后输入<code>/iso/4</code>文件夹的绝对路径。</p>
<p><img src="/../../images/98b4844bd00955f5d423ca362fe2b553.png" alt="98b4844bd00955f5d423ca362fe2b553.png"><br>选择许可证服务器的安装路径，这里选择安装在<code>$&#123;HOME&#125;/opt/SIMULIA/License/2024</code>路径下，要输入绝对路径。</p>
<p><img src="/../../images/da9c6aa1f933df48fe6027e382c878d5.png" alt="da9c6aa1f933df48fe6027e382c878d5.png"><br>这里选择默认，安装后启动许可证服务器。</p>
<p><img src="/../../images/842cf6835291e50d2a108b92c793ae29.png" alt="842cf6835291e50d2a108b92c793ae29.png"><br>选择许可证文件路径，输入绝对路径。</p>
<p><img src="/../../images/0a7fcef173dc84dbae5cd0fd3561f1d0.png" alt="0a7fcef173dc84dbae5cd0fd3561f1d0.png"><br>输入许可证文件后提示检索主机ID失败，忽略它，输入<code>2</code>继续。</p>
<p><img src="/../../images/3cdf57da3ac4f813368bc21959fd50cc.png" alt="3cdf57da3ac4f813368bc21959fd50cc.png"><br>继续选<code>2</code>。</p>
<p><img src="/../../images/37278e435bdf4ce57cc8753974ed4262.png" alt="37278e435bdf4ce57cc8753974ed4262.png"><br>确认安装信息。</p>
<p><img src="/../../images/d98331d9aec49934746e4780dc8a570f.png" alt="d98331d9aec49934746e4780dc8a570f.png"><br>安装完成，<code>Enter</code>继续下一个程序安装。</p>
<h3 id="2-3-安装求解器"><a href="#2-3-安装求解器" class="headerlink" title="2.3 安装求解器"></a>2.3 安装求解器</h3><p><img src="/../../images/e63e9f0c584011800a215af5d2c128a7.png" alt="e63e9f0c584011800a215af5d2c128a7.png"><br>选择<code>P</code>，然后输入<code>/iso/5</code>文件夹的绝对路径。</p>
<p><img src="/../../images/9da9338bf17ca917eee54135eac4bd13.png" alt="9da9338bf17ca917eee54135eac4bd13.png"><br>选择安装路径，这里选择安装在<code>$&#123;HOME&#125;/opt/SIMULIA/EstProducts/2024</code>路径下。</p>
<p><img src="/../../images/150907cf29102dc5b4bcda22e3f2af44.png" alt="150907cf29102dc5b4bcda22e3f2af44.png"><br>选择要安装的内容，全选输入<code>-1</code>。</p>
<p><img src="/../../images/618fa052254d576c29637eb792b63f5b.png" alt="618fa052254d576c29637eb792b63f5b.png"><br>选择许可证类型，默认选第<code>1</code>个。</p>
<p><img src="/../../images/2525f16acab485199fb0107493718334.png" alt="2525f16acab485199fb0107493718334.png"><br>输入许可证服务器的访问地址和端口，输入<code>29100@localhost</code>定义<code>License Server 1</code>，其余<code>Enter</code>跳过。</p>
<p><img src="/../../images/5e3f75d3e4eb45d0651f815415cec836.png" alt="5e3f75d3e4eb45d0651f815415cec836.png"><br>选择命令行程序的路径，这里选择安装到<code>$&#123;HOME&#125;/opt/SIMULIA/var/DassaultSystemes/SIMULIA/Commands</code>。</p>
<p><img src="/../../images/2dbc679c28801c1edcf17410e0541414.png" alt="2dbc679c28801c1edcf17410e0541414.png"><br>选择外部插件的路径，这里选择安装到<code>$&#123;HOME&#125;/opt/SIMULIA/var/DassaultSystemes/SIMULIA/CAE/plugins/2024</code>。</p>
<p><img src="/../../images/0ab546bf5c53e748044cb596a40aac68.png" alt="0ab546bf5c53e748044cb596a40aac68.png"><br>选择<code>Tosca</code>的接口，根据实际需要来。</p>
<p><img src="/../../images/575d8708a07ed1bc9781af02aa739e58.png" alt="575d8708a07ed1bc9781af02aa739e58.png"><br>选择<code>Tosca Fluid</code>工作目录，这里指派到<code>$&#123;HOME&#125;/temp</code>下。</p>
<p><img src="/../../images/f9de5443a5f54c198a15d433cbcc459d.png" alt="f9de5443a5f54c198a15d433cbcc459d.png"><br>选择STAR-CCM+安装路径，根据实际情况设置，默认留空。</p>
<p><img src="/../../images/bfade401e6f700848f6166f118eb2204.png" alt="bfade401e6f700848f6166f118eb2204.png"><br>选择STAR-CCM+许可证，根据实际情况设置，默认留空。</p>
<p><img src="/../../images/817069e8e89653272d962e4a6553940e.png" alt="817069e8e89653272d962e4a6553940e.png"><br>选择Fluent安装路径，根据实际情况设置，默认留空。</p>
<p><img src="/../../images/4b87a12aa92cdc9ef67cb2596b331bc1.png" alt="4b87a12aa92cdc9ef67cb2596b331bc1.png"><br>确认安装信息，<code>Enter</code>开始复制文件。</p>
<p><img src="/../../images/a48dc4111041562afdd9c43a3f853613.png" alt="a48dc4111041562afdd9c43a3f853613.png"><br>安装过程中会启动验算程序，可以查看验算结果。<code>Enter</code>继续。</p>
<p><img src="/../../images/192460b7772483522ff8ff97c5f47f61.png" alt="192460b7772483522ff8ff97c5f47f61.png"><br>求解器安装完成，<code>Enter</code>退出，进入下一个安装程序。</p>
<h3 id="2-4-安装CAA-API"><a href="#2-4-安装CAA-API" class="headerlink" title="2.4 安装CAA API"></a>2.4 安装CAA API</h3><p><img src="/../../images/a1105475937fa8f0c85abdf177501160.png" alt="a1105475937fa8f0c85abdf177501160.png"><br>选择<code>P</code>，然后输入<code>/iso/6</code>文件夹的绝对路径。</p>
<p><img src="/../../images/fbe21029d223f693d9cdfd727ec588c4.png" alt="fbe21029d223f693d9cdfd727ec588c4.png"><br>选择安装路径，这里选择安装到<code>$&#123;HOME&#125;/opt/SIMULIA/EstProducts/2024</code>。</p>
<p><img src="/../../images/098367e7a54310e3ceefee9c52659171.png" alt="098367e7a54310e3ceefee9c52659171.png"><br>确认要安装的内容，<code>Enter</code>继续。</p>
<p><img src="/../../images/2e23fd22aea12099636c0c53efb9b011.png" alt="2e23fd22aea12099636c0c53efb9b011.png"><br>完成安装，<code>Enter</code>退出。</p>
<h3 id="2-5-安装Isight"><a href="#2-5-安装Isight" class="headerlink" title="2.5 安装Isight"></a>2.5 安装Isight</h3><p><img src="/../../images/58015ba8b4b0068cfcb447f20857939f.png" alt="58015ba8b4b0068cfcb447f20857939f.png"><br>选择安装路径，这里选择安装到<code>$&#123;HOME&#125;/opt/SIMULIA/Isight/2024</code>。</p>
<p><img src="/../../images/48a30d42cac1ed6b1b91f2ce39040cce.png" alt="48a30d42cac1ed6b1b91f2ce39040cce.png"><br>选择要安装的内容，<code>-1</code>全选。</p>
<p><img src="/../../images/741fd85d5d3f278d9bb7f9bf6530c60a.png" alt="741fd85d5d3f278d9bb7f9bf6530c60a.png"><br>是否启动<code>TomEE</code>配置工具，默认跳过。</p>
<p><img src="/../../images/bcda28276dc83f5ae970fcfa37300078.png" alt="bcda28276dc83f5ae970fcfa37300078.png"><br>这一步也默认跳过吧。</p>
<p><img src="/../../images/b6652ff01997c5fa5e1375d92be835f3.png" alt="b6652ff01997c5fa5e1375d92be835f3.png"><br>没有安装文档，选择跳过吧。</p>
<p><img src="/../../images/952737d22e78e4dd5cbb2fddf27e9bc4.png" alt="952737d22e78e4dd5cbb2fddf27e9bc4.png"><br>确认安装内容，<code>Enter</code>开始复制文件。</p>
<p><img src="/../../images/f27fe27fbc46bb915c1fe167d235753f.png" alt="f27fe27fbc46bb915c1fe167d235753f.png"><br>安装完成，<code>Enter</code>退出。</p>
<h3 id="2-6-安装完成"><a href="#2-6-安装完成" class="headerlink" title="2.6 安装完成"></a>2.6 安装完成</h3><p><img src="/../../images/2f4f47eb05fb870bb885b5ccfb13a9aa.png" alt="2f4f47eb05fb870bb885b5ccfb13a9aa.png"><br>确认安装结果，<code>Enter</code>退出SIMULIA安装程序。</p>
<h2 id="3-安装后配置"><a href="#3-安装后配置" class="headerlink" title="3. 安装后配置"></a>3. 安装后配置</h2><h3 id="3-1-启动配置"><a href="#3-1-启动配置" class="headerlink" title="3.1 启动配置"></a>3.1 启动配置</h3><p>启动之前要修改配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="variable">$&#123;HOME&#125;</span>/opt/SIMULIA/EstProducts/2024/linux_a64/SMA/site/custom_v6.<span class="built_in">env</span></span><br></pre></td></tr></table></figure>

<p>在最末尾增加两行内容，保存退出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">license_server_type=FLEXNET</span><br><span class="line">abaquslm_license_file=<span class="string">&quot;29100@localhost&quot;</span></span><br></pre></td></tr></table></figure>

<p>新建环境变量配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> <span class="variable">$&#123;HOME&#125;</span>/opt/SIMULIA/simulia24.<span class="built_in">env</span></span><br><span class="line"><span class="built_in">chmod</span> +x <span class="variable">$&#123;HOME&#125;</span>/opt/SIMULIA/simulia24.<span class="built_in">env</span></span><br><span class="line">vim <span class="variable">$&#123;HOME&#125;</span>/opt/SIMULIA/simulia24.<span class="built_in">env</span></span><br></pre></td></tr></table></figure>

<p>编辑内容如下，最好都用绝对路径，保存退出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LICENSE_PREFIX_DIR=<span class="variable">$&#123;HOME&#125;</span>/opt/SIMULIA/License/2024/linux_a64/code/bin</span><br><span class="line"><span class="built_in">export</span> SIMULIA_COMMAND_DIR=<span class="variable">$&#123;HOME&#125;</span>/opt/SIMULIA/var/DassaultSystemes/SIMULIA/Commands</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$SIMULIA_COMMAND_DIR</span>:<span class="variable">$LICENSE_PREFIX_DIR</span>:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> LM_LICENSE_FILE=29100@localhost</span><br></pre></td></tr></table></figure>

<p>运行以下命令载入环境变量：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> <span class="variable">$&#123;HOME&#125;</span>/opt/SIMULIA/simulia24.<span class="built_in">env</span></span><br></pre></td></tr></table></figure>

<p>通过以下命令启动Abaqus图形界面[^1]：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abaqus cae -mesa</span><br><span class="line">abaqus view -mesa</span><br></pre></td></tr></table></figure>

<h3 id="3-2-许可证安装问题"><a href="#3-2-许可证安装问题" class="headerlink" title="3.2 许可证安装问题"></a>3.2 许可证安装问题</h3><p>如果<a href="#31-%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE">3.1</a>中Abaqus能正常启动，那么这一步骤可以跳过了。</p>
<p>验证许可证服务器是否在运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -eaf | grep ABAQUSLM</span><br></pre></td></tr></table></figure>

<p>发现许可证服务器没有运行，通过以下命令启动许可证服务器：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;HOME&#125;</span>/opt/SIMULIA/License/2024/linux_a64/code/bin/licenseStartup.sh</span><br></pre></td></tr></table></figure>

<p>启动未成功，报错信息如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/***/opt/SIMULIA/License/2024/linux_a64/code/bin/licenseStartup.sh: 2: /home/***/opt/SIMULIA/License/2024/linux_a64/code/bin/lmgrd: not found</span><br></pre></td></tr></table></figure>

<p>无解了，这要么是安装包有问题，要么是这个发行版缺少了某些运行库，等大佬出手吧。</p>
<p>不过好在Windows版许可证可以正常安装，只需要将许可证路径指派到Windows机器上即可。首先在Windows防火墙中打开29100端口，新建防火墙入站规则：<br><img src="/../../images/33aec1f9e7b7132dc0d6143a9d9d25fe.png" alt="33aec1f9e7b7132dc0d6143a9d9d25fe.png"></p>
<p>然后将<a href="#31-%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE">3.1</a>中<code>custom_v6.env</code>文件的许可证地址修改如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">license_server_type=FLEXNET</span><br><span class="line"><span class="comment"># abaquslm_license_file=&quot;29100@localhost&quot;</span></span><br><span class="line">abaquslm_license_file=<span class="string">&quot;29100@172.25.64.1&quot;</span> <span class="comment"># 172.25.64.1为Windows主机IP地址</span></span><br></pre></td></tr></table></figure>

<p>修改环境变量文件<code>$&#123;HOME&#125;/opt/SIMULIA/simulia24.env</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># export LM_LICENSE_FILE=29100@localhost</span></span><br><span class="line"><span class="built_in">export</span> LM_LICENSE_FILE=29100@172.25.64.1</span><br></pre></td></tr></table></figure>

<p>载入环境变量后，通过<code>abaqus cae</code>命令可以正常启动，不会再提示许可证问题。<br><img src="/../../images/%E6%88%AA%E5%9B%BE%202025-03-21%2015-16-50.png" alt="截图 2025-03-21 15-16-50.png"></p>
<p>不得不承认，Linux的图形界面确实不好用，但是谁关心呢？反正又不会在Linux下画图、处理网格，能提交计算就行了。</p>
<h3 id="3-3-提交集群计算"><a href="#3-3-提交集群计算" class="headerlink" title="3.3 提交集群计算"></a>3.3 提交集群计算</h3><p>Abaqus的Slurm脚本[^2]参考如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SBATCH --job-name=abaqus_test</span></span><br><span class="line"><span class="comment">#SBATCH --partition=debug </span></span><br><span class="line"><span class="comment">#SBATCH --output=%j.out </span></span><br><span class="line"><span class="comment">#SBATCH --error=%j.err </span></span><br><span class="line"><span class="comment">#SBATCH -N 1 </span></span><br><span class="line"><span class="comment">#SBATCH --ntasks-per-node=32 </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$SLURM_SUBMIT_DIR</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /home/***/opt/SIMULIA/simulia24.<span class="built_in">env</span> <span class="comment"># 填写绝对路径</span></span><br><span class="line"><span class="built_in">export</span> INPFILE=`find . -name <span class="string">&quot;*.inp&quot;</span>`</span><br><span class="line"><span class="built_in">export</span> ENVFILE=/home/***/opt/SIMULIA/EstProducts/2024/linux_a64/SMA/site/abaqus_v6.<span class="built_in">env</span> <span class="comment"># 填写绝对路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成abaqus_6.env文件，指定hosts</span></span><br><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$PWD</span>/abaqus_v6.<span class="built_in">env</span></span><br><span class="line"><span class="built_in">cp</span> <span class="variable">$ENVFILE</span> <span class="variable">$PWD</span>/abaqus_v6.<span class="built_in">env</span></span><br><span class="line">node_list=$(scontrol show hostname <span class="variable">$&#123;SLURM_NODELIST&#125;</span> | <span class="built_in">sort</span> -u)</span><br><span class="line">mp_host_list=<span class="string">&quot;[&quot;</span></span><br><span class="line"><span class="keyword">for</span> host <span class="keyword">in</span> <span class="variable">$&#123;node_list&#125;</span>; <span class="keyword">do</span></span><br><span class="line">    mp_host_list=<span class="string">&quot;<span class="variable">$&#123;mp_host_list&#125;</span>[&#x27;<span class="variable">$host</span>&#x27;, <span class="variable">$&#123;SLURM_NTASKS_PER_NODE&#125;</span>],&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">mp_host_list=$(<span class="built_in">echo</span> <span class="variable">$&#123;mp_host_list&#125;</span> | sed -e <span class="string">&quot;s/,$/]/&quot;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;mp_host_list=<span class="variable">$&#123;mp_host_list&#125;</span>&quot;</span>  &gt;&gt; <span class="variable">$PWD</span>/abaqus_v6.<span class="built_in">env</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Scratch目录</span></span><br><span class="line"><span class="built_in">mkdir</span> scratch.<span class="variable">$SLURM_JOB_ID</span></span><br><span class="line"></span><br><span class="line">abaqus job=<span class="variable">$SLURM_JOB_NAME</span> input=<span class="variable">$INPFILE</span> cpus=<span class="variable">$SLURM_NPROCS</span> scratch=scratch.<span class="variable">$SLURM_JOB_ID</span> mp_mode=mpi double=both output_precision=full resultsformat=odb int ask=off &gt; <span class="variable">$SLURM_JOB_NAME</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">rm</span> -rf <span class="variable">$PWD</span>/abaqus_v6.<span class="built_in">env</span> scratch.<span class="variable">$SLURM_JOB_ID</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将<code>inp</code>文件和脚本放到同一文件夹，使用<code>sbatch</code>命令提交脚本。计算完成后下载结果到本机，用<code>Abaqus Viewer</code>或<code>Meta</code>查看结果。</p>
<p>[^1]: <a target="_blank" rel="noopener" href="https://github.com/franaudo/abaqus-ubuntu">franaudo&#x2F;abaqus-ubuntu </a></p>
<p>[^2]: <a target="_blank" rel="noopener" href="https://github.com/abhpc/ABHPC-Guide/tree/master">abhpc&#x2F;ABHPC-Guide </a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Linux/Ubuntu%E5%AE%89%E8%A3%85SIMULIA2024/" data-id="cm8orjgqj000dpw095byycxuz" data-title="Ubuntu安装SIMULIA2024" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux/Hyper-V虚拟交换机NAT设置静态IP" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Linux/Hyper-V%E8%99%9A%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BANAT%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:29.911Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Linux/Hyper-V%E8%99%9A%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BANAT%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP/">Hyper-V虚拟交换机NAT设置静态IP</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>21&#x2F;03&#x2F;2025</p>
<hr>
<p>前面讲过用NAT+端口映射的方式访问虚拟机，但使用过程中发现一个问题：每次宿主机重启之后，默认的<code>Default Switch</code>IP地址都会变更，造成虚拟机无法访问网关进而无法联网。</p>
<p>为了保证虚拟机联网，每次重启开机都要手动设置<code>Default Switch</code>对应适配器的IP地址，非常不便。下面是参考<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/virtualization/hyper-v-on-windows/user-guide/setup-nat-network">微软官方文档</a>给出的解决方案。</p>
<p>这里前面的步骤可以通过图形用户界面去实现，首先新建一个内部的虚拟交换机：<br><img src="/../../images/38530a4ee6eaabf98448a647c0446d0c.png" alt="38530a4ee6eaabf98448a647c0446d0c.png"></p>
<p>命名虚拟交换机，记住它，后面会用到。确定新建：<br><img src="/../../images/2d9b503b6087be2acffc63498abc5977.png" alt="2d9b503b6087be2acffc63498abc5977.png"></p>
<p>在Windows网络适配器中找到新建的虚拟机适配器，将IP地址改成虚拟机设置的网关地址，子网掩码也改成和虚拟机设置的一致：<br><img src="/../../images/e4140c00e7140a6ad234b58fa208caa9.png" alt="e4140c00e7140a6ad234b58fa208caa9.png"></p>
<p>下面用管理员权限打开PowerShell，通过以下命令行查看是否已有NAT网络：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-NetNat</span></span><br></pre></td></tr></table></figure>

<p>因为一个机器上只能有一个NAT网络，因此要先移除现有的NAT网络：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-NetNat</span> | <span class="built_in">Remove-NetNat</span></span><br></pre></td></tr></table></figure>

<p>设置NAT网络：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># InLan为NAT网络名称，172.25.64.0为子网网关IP地址，/24为子网前缀长度</span></span><br><span class="line"><span class="built_in">New-NetNat</span> <span class="literal">-Name</span> InLan <span class="literal">-InternalIPInterfaceAddressPrefix</span> <span class="number">172.25</span>.<span class="number">64.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure>
<p>关于子网网关，和上面设置的虚拟机适配器的IP地址即虚拟机的网关地址处在同一个网段即可，末尾设置为0；本例上面虚拟机的网关地址为172.25.64.1，那子网网关地址一般设置为172.25.64.0。子网前缀即子网掩码，关于子网前缀长度，通俗来讲，像2xx.2xx.2xx.0这种都是24位，2xx.2xx.2xx.2xx这种为32位。</p>
<p>设置完成后通过Get-NetNat查看是否有NAT网络信息：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Name                             : InLan</span><br><span class="line">ExternalIPInterfaceAddressPrefix :</span><br><span class="line">InternalIPInterfaceAddressPrefix : <span class="number">172.25</span>.<span class="number">64.0</span>/<span class="number">24</span></span><br><span class="line">IcmpQueryTimeout                 : <span class="number">30</span></span><br><span class="line">TcpEstablishedConnectionTimeout  : <span class="number">1800</span></span><br><span class="line">TcpTransientConnectionTimeout    : <span class="number">120</span></span><br><span class="line">TcpFilteringBehavior             : AddressDependentFiltering</span><br><span class="line">UdpFilteringBehavior             : AddressDependentFiltering</span><br><span class="line">UdpIdleSessionTimeout            : <span class="number">120</span></span><br><span class="line">UdpInboundRefresh                : False</span><br><span class="line">Store                            : Local</span><br><span class="line">Active                           : True</span><br></pre></td></tr></table></figure>

<p>这样新的NAT网络就配置好了，在虚拟机设置中更换成新设置的虚拟交换机。<br><img src="/../../images/0dede2ea198412fb98f352185b8c299c.png" alt="0dede2ea198412fb98f352185b8c299c.png"></p>
<p>再登录虚拟机，手动设置DNS即可（不理解为什么不能通过网关自动获取DNS，也许是BUG……），否则虚拟机无法访问外网。<br><img src="/../../images/03ac4a6c4f91bb45fc4fd1d30483119b.png" alt="03ac4a6c4f91bb45fc4fd1d30483119b.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Linux/Hyper-V%E8%99%9A%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BANAT%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP/" data-id="cm8orjgqh000apw097sdb8vys" data-title="Hyper-V虚拟交换机NAT设置静态IP" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux/Ubuntu安装Slurm" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Linux/Ubuntu%E5%AE%89%E8%A3%85Slurm/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:29.908Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Linux/Ubuntu%E5%AE%89%E8%A3%85Slurm/">Ubuntu安装Slurm</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>20&#x2F;03&#x2F;2025</p>
<hr>
<p>Slurm，和PBS、LSF一样，超算上常用的任务管理系统。Slurm优点是开源免费、活跃度很高，近几年国内新兴的超算平台几乎都提供了Slurm作为主要的任务管理系统。PBS开源后活跃度低得可怜，更新到最新系统后安装一直出问题，提了issue也不见答复。LSF有版权风险，国内应用也不多，属于很少见的类型。至于命令和脚本，这三家都大差不差，学会了其中一家另外的也是手到擒来。</p>
<p>Ubuntu安装Slurm还是十分简单的，重要的工具基本都编译好了，直接apt安装即可，其他依赖项会自动安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install slurmd	<span class="comment"># 安装计算节点守护进程</span></span><br><span class="line"><span class="built_in">sudo</span> apt install slurmctld <span class="comment"># 安装管理节点守护进程</span></span><br></pre></td></tr></table></figure>

<p>Slurm需要有一个专门的用户用于通信等操作，这个用户的默认用户名是<code>slurm</code>，上面的命令其实已经自动在Ubuntu中生成了<code>slurm</code>用户，可以通过下面的命令验证：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lastlog | grep slurm</span><br></pre></td></tr></table></figure>

<p>如果Ubuntu没有生成<code>slurm</code>用户，可以用以下命令生成：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> useradd slurm</span><br></pre></td></tr></table></figure>

<p>Slurm配置文件主要在 <code>/etc/slurm/</code> 目录下，主配置文件：<code>/etc/slurm/slurm.conf</code>，我们需要生成配置文件。官方提供了辅助生成配置文件的工具：<a target="_blank" rel="noopener" href="https://slurm.schedmd.com/configurator.html">Slurm Configuration Tool</a> 。</p>
<p>根据网页内容提示，填写配置文件其中一些关键部分：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ClusterName=Cluster <span class="comment"># 集群命名，任意英文和数字组合</span></span><br><span class="line"></span><br><span class="line">SlurmctldHost=dell-vm <span class="comment"># 管理节点，这里填本机名称</span></span><br><span class="line"></span><br><span class="line">NodeName=dell-vm <span class="comment"># 计算节点，同样填本机名称</span></span><br><span class="line">PartitionName=debug <span class="comment"># 计算节点所在分区，默认为debug</span></span><br><span class="line">CPUs=32 <span class="comment"># 计算节点CPU核心数，根据实际情况填写</span></span><br><span class="line">Sockets=1 <span class="comment"># CPU插槽数，根据实际情况填写</span></span><br><span class="line">CoresPerSocket＝32 <span class="comment"># 每插槽核心数，根据实际情况填写</span></span><br><span class="line">ThreadsPerCore=1 <span class="comment"># 每核心线程数，建议为1，不建议打开超线程</span></span><br><span class="line"></span><br><span class="line">SlurmUser=slurm <span class="comment"># 默认为slurm用户，不建议改成root用户</span></span><br><span class="line"></span><br><span class="line">StateSaveLocation=/var/spool/slurmctld <span class="comment"># 管理节点守护进程的存储文件夹，默认即可</span></span><br><span class="line">SlurmdSpoolDir=/var/spool/slurmd <span class="comment"># 计算点守护进程的存储文件夹，默认即可</span></span><br></pre></td></tr></table></figure>
<p>更多解释可以参考中科大网站上的信息。<sup>(1)</p>
<p>网页内容填写完成后点击最下面的<code>Submit</code>，把显示的配置文件模板拷贝下来，存到<code>/etc/slurm/slurm.conf</code>文件中：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/slurm/slurm.conf	<span class="comment"># 复制粘贴到这个文件里</span></span><br></pre></td></tr></table></figure>

<p>生成守护进程的读写文件夹：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> /var/spool/slurmd <span class="comment"># Ubuntu下提示文件夹已存在，无视它</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> /var/spool/slurmctld</span><br></pre></td></tr></table></figure>

<p>启动Slurm的服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> slurmd</span><br><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> slurmctld</span><br><span class="line"><span class="built_in">sudo</span> systemctl start slurmd</span><br><span class="line"><span class="built_in">sudo</span> systemctl start slurmctld</span><br></pre></td></tr></table></figure>

<p>查看Slurm守护进程的启动状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl status slurmd</span><br><span class="line"><span class="built_in">sudo</span> systemctl status slurmctld</span><br></pre></td></tr></table></figure>

<p><code>slurmd</code>守护进程启动成功，但<code>slurmctld</code>守护进程启动报错，查看报错信息如下：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(null): _log_init: Unable to open logfile `/var/log/slurmctld.log&#x27;: Permission denied</span><br><span class="line">slurmctld: fatal: Incorrect permissions on state save loc: /var/spool/slurmctld</span><br></pre></td></tr></table></figure>

<p>为解决这个问题，最简单办法是将<code>SlurmUser</code>改为<code>root</code>。这里采用另外一种方法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">touch</span> /var/log/slurmctld.log <span class="comment"># 创建slurmctld守护进程的日志文件</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chown</span> slurm /var/log/slurmctld.log <span class="comment"># 将日志文件所有者改为slurm用户</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chown</span> -R slurm /var/spool/slurmctld <span class="comment"># 将slurmctld守护进程读写文件夹的所有者改为slurm用户</span></span><br></pre></td></tr></table></figure>

<p>重新启动<code>slurmctld</code>服务即可：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart slurmctld</span><br></pre></td></tr></table></figure>

<p>Slurm脚本和命令行，国内的用户可以参考交大编写的用户手册，比较全面，这里就不一一列举了。<sup>(2) </p>
<p>以下是一些常用Slurm命令：</p>
<ul>
<li><p>当前节点的配置可以通过以下命令获取：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slurmd -C</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看当前集群的节点状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sinfo -N</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看指定节点信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scontrol show node dell-vm <span class="comment"># dell-vm是计算节点的名称</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看当前用户提交的任务信息，通常只显示正在排队和运行中的任务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">squeue</span><br></pre></td></tr></table></figure>
</li>
<li><p>提交计算任务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sbatch jobscript.slurm <span class="comment"># jobscript.slurm为用户编写的计算脚本，可不带后缀名</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看和修改任务状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scontrol show job <span class="variable">$&#123;JOB_ID&#125;</span> <span class="comment"># 查看指定任务的信息，$&#123;JOB_ID&#125;对应squeue显示的第一列的任务编号</span></span><br><span class="line">scontrol hold <span class="variable">$&#123;JOB_ID&#125;</span> <span class="comment"># 暂停$&#123;JOB_ID&#125;</span></span><br><span class="line">scontrol release <span class="variable">$&#123;JOB_ID&#125;</span> <span class="comment"># 恢复$&#123;JOB_ID&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>取消计算任务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scancel <span class="variable">$&#123;JOB_ID&#125;</span> <span class="comment"># 取消$&#123;JOB_ID&#125;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<p><sup>(1) <a target="_blank" rel="noopener" href="https://scc.ustc.edu.cn/hmli/doc/linux/slurm-install/slurm-install.html#id17">Slurm资源管理与作业调度系统安装配置</a></p>
<p><sup>(2) <a target="_blank" rel="noopener" href="https://docs.hpc.sjtu.edu.cn/job/slurm.html">Slurm 作业调度系统</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Linux/Ubuntu%E5%AE%89%E8%A3%85Slurm/" data-id="cm8orjgqj000epw09cgc316r4" data-title="Ubuntu安装Slurm" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux/Ubuntu挂载Windows共享文件夹(cifs+nfs)" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Linux/Ubuntu%E6%8C%82%E8%BD%BDWindows%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9(cifs+nfs)/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:29.907Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Linux/Ubuntu%E6%8C%82%E8%BD%BDWindows%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9(cifs+nfs)/">Ubuntu挂载Windows共享文件夹(cifs+nfs)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>20&#x2F;03&#x2F;2025</p>
<hr>
<p>在虚拟机中运行计算文件，会导致虚拟磁盘膨胀，占用太多磁盘空间。这个时候可以通过挂载宿主机文件夹的形式，把计算文件转移到宿主机磁盘上，避免了虚拟磁盘膨胀的问题。<br>在Windows中建立共享文件夹，这里省略了，只需要确保虚拟机能通过IP地址访问宿主机即可。</p>
<h2 id="1-查看资源路径"><a href="#1-查看资源路径" class="headerlink" title="1. 查看资源路径"></a>1. 查看资源路径</h2><p>以下命令查看服务器共享出来的资源路径，确认挂载点：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L 172.25.64.1 -U <span class="variable">$&#123;username&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/915cf6282a8325b667b52d37dea315f0.png" alt="915cf6282a8325b667b52d37dea315f0.png"><br>挂载点访问路径：<code>//172.25.64.1/Share</code></p>
<h2 id="2-挂载方法"><a href="#2-挂载方法" class="headerlink" title="2. 挂载方法"></a>2. 挂载方法</h2><p>想要在Ubuntu中访问Windows共享文件夹，首先得安装cifs工具：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install cifs-utils</span><br></pre></td></tr></table></figure>

<p>然后通过<code>mount</code>命令挂载共享文件夹：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount -t cifs //172.25.64.1/Share /mnt -o username=<span class="variable">$&#123;username&#125;</span>,password=<span class="variable">$&#123;password&#125;</span></span><br></pre></td></tr></table></figure>
<p>这里的IP地址<code>172.25.64.1</code>是虚拟机中访问的宿主机的网关地址，<code>Share</code>是宿主机共享的文件夹，<code>/mnt</code>是要挂载到的虚拟机本地访问路径，把命令后面的<code>$&#123;username&#125;</code>和<code>$&#123;password&#125;</code>替换成访问用户名和密码即可。<br>需要注意的是，Windows本地用户的用户名需要写成<code>$&#123;计算机名&#125;\$&#123;用户名&#125;</code>的形式，用反斜杠连接，例如：<code>xxx-desktop\administrator</code>。如果是在线账户的话就需要填写完整的邮件账户名称。<br>如果密码中包含逗号等特殊转义字符的话，命令行就不要包含<code>,password=</code>及后面的内容，后续根据提示输入密码登录。</p>
<p>如果出现无读写权限的问题，挂载命令中增加<code>dir_mode=0777,file_mode=0777</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount -t cifs //172.25.64.1/Share /mnt -o dir_mode=0777,file_mode=0777,username=<span class="variable">$&#123;username&#125;</span>,password=<span class="variable">$&#123;password&#125;</span></span><br></pre></td></tr></table></figure>

<p>如果想只添加某些特定用户的读写权限，通过<code>uid</code>和<code>gid</code>指定用户和组：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount -t cifs //172.25.64.1/Share /mnt -o uid=user,gid=group,username=<span class="variable">$&#123;username&#125;</span>,password=<span class="variable">$&#123;password&#125;</span></span><br></pre></td></tr></table></figure>

<p>通过<code>mount</code>命令可以查看挂载情况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount | grep cifs</span><br></pre></td></tr></table></figure>
<p><img src="/../../images/b9e4cda2700bd92ba7d89159f79cc007.png" alt="b9e4cda2700bd92ba7d89159f79cc007.png"></p>
<p>取消挂载通过<code>umount</code>命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> umount /mnt</span><br></pre></td></tr></table></figure>

<p>如果想开机自动挂载的话，就需要编辑<code>/etc/fstab</code>，内容如下:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//172.25.64.1/Share /mnt cifs auto,dir_mode=0777,file_mode=0777,username=$&#123;username&#125;,password=$&#123;password&#125; 0 0</span><br></pre></td></tr></table></figure>

<h2 id="3-特殊字符密码"><a href="#3-特殊字符密码" class="headerlink" title="3. 特殊字符密码"></a>3. 特殊字符密码</h2><p>对于密码含有特殊转义字符的情况，要在Linux开机时实现自动挂载Windows共享文件夹，可以采取以下方法<a href="%5BLinux%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BDwindow%E5%AF%86%E7%A0%81%E6%9C%89%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6%E7%9A%84%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9%5D(https://blog.csdn.net/qq_37959253/article/details/135715798)">^1</a>：</p>
<ol>
<li><p>创建凭证文件：为保持密码的安全性，最好将Windows共享的用户名和密码保存在一个只有root权限能访问的文件中，例如：<code>/etc/cifs-credentials</code>，并确保它的权限设置为仅root可读。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">touch</span> /etc/cifs-credentials</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 600 /etc/cifs-credentials</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用文本编辑器编辑该文件， 如果密码中包含特殊字符，直接在文件中输入即可(无需转义)，写入用户名（xxx-desktop\administrator）和密码（123456,abcde）:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=xxx-desktop\administrator</span><br><span class="line">password=123456,abcde</span><br></pre></td></tr></table></figure></li>
<li><p>编辑 <code>/etc/fstab</code> 文件：打开 <code>/etc/fstab</code> 文件，在文件末尾添加如下内容，以包含挂载信息：</p>
 <figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//172.25.64.1/Share /mnt cifs credentials=/etc/cifs-credentials,iocharset=utf8,file_mode=0777,dir_mode=0777 0 0</span><br></pre></td></tr></table></figure>
<p> 注意<code>/etc/cifs-credentials</code>文件的编码需要是UTF-8。</p>
</li>
</ol>
<p>以上便完成了开机自动挂载设置，重启后可以通过<code>df -h</code>验证。<br><img src="/../../images/8bcbb069683deec77050415a12e0edc1.png" alt="8bcbb069683deec77050415a12e0edc1.png"></p>
<h2 id="4-权限问题"><a href="#4-权限问题" class="headerlink" title="4. 权限问题"></a>4. 权限问题</h2><p>使用cifs挂载Windows的共享文件夹，chmod和chown等命令失效，无法调整被挂载的文件和文件夹权限。这里采用NFS(网络文件系统)挂载共享文件夹以解决此问题。</p>
<p>默认情况下，NFS并不提供任何验证机制，因此不需要验证用户名密码，存在一定的安全风险。NFSv3根据客户端IP地址完成验证<a href="%5BNFS%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%5D(https://developer.aliyun.com/article/1629577)">^2</a>，可以通过指定客户端IP地址的方式提高安全性。</p>
<p>Windows10可以通过第三方工具haneWIN<a href="%5BhaneWIN%5D(https://www.hanewin.net/nfs-e.htm)">^3</a>创建NFS共享文件夹，下载安装并通过图形界面配置即可，这里不详细介绍，可以参考其他相关文章[^4]。注意配置完成后要在防火墙中开放相关端口。<br><img src="/../../images/4581ebf45d084151983b8c35aa9a88ac.png" alt="4581ebf45d084151983b8c35aa9a88ac.png"></p>
<p>在Ubuntu上安装NFS相关工具，开启相关服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install nfs-common rpcbind</span><br><span class="line"><span class="built_in">sudo</span> systemctl start rpcbind</span><br><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> rpcbind</span><br></pre></td></tr></table></figure>

<p>使用<code>mount</code>命令挂载共享目录。注意后面的<code>-t nfs</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount -t nfs 172.25.64.1:/Share /mnt </span><br></pre></td></tr></table></figure>

<p>取消挂载命令和cifs是一样的，当网络状态突然中断时可以增加<code>-lf</code>开关：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> umount -lf /mnt</span><br></pre></td></tr></table></figure>

<p>编辑<code>/etc/fstab</code>，添加开机自动挂载：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">172.25.64.1:/Share	/mnt	nfs	defaults,_netdev 0 0</span><br></pre></td></tr></table></figure>

<p>[^4]: <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2404222">Windows服务器使用haneWIN NFS Server快速搭建NFS服务并挂载到Linux服务器</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Linux/Ubuntu%E6%8C%82%E8%BD%BDWindows%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9(cifs+nfs)/" data-id="cm8orjgqk000fpw09fod32zxz" data-title="Ubuntu挂载Windows共享文件夹(cifs+nfs)" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Linux/Hyper-V安装Ubuntu24.04" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Linux/Hyper-V%E5%AE%89%E8%A3%85Ubuntu24.04/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:29.903Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Linux/Hyper-V%E5%AE%89%E8%A3%85Ubuntu24.04/">Hyper-V安装Ubuntu24.04</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>19&#x2F;03&#x2F;2025</p>
<hr>
<p>[TOC]</p>
<hr>
<h2 id="1-需求"><a href="#1-需求" class="headerlink" title="1. 需求"></a>1. 需求</h2><p>考虑在新电脑上安装Linux，不是双系统，因为还要满足日常办公。不喜欢折腾的可以用WSL，这里用Hyper-V实现，同时通过端口映射实现外网访问虚拟机。</p>
<h2 id="2-准备工作"><a href="#2-准备工作" class="headerlink" title="2. 准备工作"></a>2. 准备工作</h2><h3 id="2-1-下载Ubuntu"><a href="#2-1-下载Ubuntu" class="headerlink" title="2.1 下载Ubuntu"></a>2.1 下载Ubuntu</h3><p>笔者是做CFD的，自然离不开Fluent，这玩意儿挑发行版的。从官网资料确认支持哪个发行版，支持哪个就装哪个，免得后面倒腾回来重装系统。</p>
<p><a target="_blank" rel="noopener" href="https://www.ansys.com/content/dam/it-solutions/platform-support/2024-r1/ansys-platform-support-strategy-plans-january-2024.pdf">Ansys Computing Platform Support 2024R1</a></p>
<p>这里选择Ubuntu，前往官网下载最新的发行版。</p>
<p><img src="/../../images/2fd636d62e1453b3b54ad4074cde6c48.png" alt="2fd636d62e1453b3b54ad4074cde6c48.png"></p>
<h3 id="2-2-开启Hyper-V支持"><a href="#2-2-开启Hyper-V支持" class="headerlink" title="2.2 开启Hyper-V支持"></a>2.2 开启Hyper-V支持</h3><p>在开始菜单搜索“启用或关闭Windows功能”，开启虚拟化支持。</p>
<p><img src="/../../images/973c3b93cf91c5138b89bbeaeb2bf103.png" alt="973c3b93cf91c5138b89bbeaeb2bf103.png"></p>
<p>把Hyper-V勾上，安装并重启就行了。</p>
<p><img src="/../../images/4e7e7f54c61f0f16af1595cb8c0b220e.png" alt="4e7e7f54c61f0f16af1595cb8c0b220e.png"></p>
<h2 id="3-安装虚拟机系统"><a href="#3-安装虚拟机系统" class="headerlink" title="3. 安装虚拟机系统"></a>3. 安装虚拟机系统</h2><p>Hyper-V启动界面，跟着向导一步步新建虚拟机即可。</p>
<p><img src="/../../images/25cb47dca10625386e38f7279396a047.png" alt="25cb47dca10625386e38f7279396a047.png"></p>
<p>需要注意几点：</p>
<ul>
<li>虚拟机和虚拟磁盘最好指定在其他空余空间比较多的分区上，后面运行频繁读写会使虚拟磁盘文件膨胀的很大。</li>
<li>第一次启动前最大内存分配小一点，不然启动很花时间，建议安装并配置完虚拟机系统后再调整到想要的内存大小。</li>
<li>虚拟机设置可以打开TPM，但是要关掉安全启动（除非启用<code>Microsoft UEFI证书颁发机构</code>），否则无法载入安装盘。</li>
</ul>
<p><img src="/../../images/e9ab97e9373fcdcdc872cf58a6e460e5.png" alt="e9ab97e9373fcdcdc872cf58a6e460e5.png"></p>
<p>Ubuntu安装过程不仔细说明了，跟着向导界面一步步安装即可。</p>
<h2 id="4-配置虚拟机网格"><a href="#4-配置虚拟机网格" class="headerlink" title="4. 配置虚拟机网格"></a>4. 配置虚拟机网格</h2><h3 id="4-1-虚拟机分配IP地址"><a href="#4-1-虚拟机分配IP地址" class="headerlink" title="4.1 虚拟机分配IP地址"></a>4.1 虚拟机分配IP地址</h3><p>我们需要通过端口映射访问虚拟机，因此需要给虚拟机指派一个固定的IP地址。由于虚拟机用的是默认的<code>Default Switch</code>桥接设置，需要查看宿主机给改适配器指派的IP地址，在网络连接选项中可以查看：<br><img src="/../../images/b8722552e9541a08ce84dd77b04c40ce.png" alt="b8722552e9541a08ce84dd77b04c40ce.png"></p>
<p>上图显示的地址就是虚拟机访问宿主机的IP地址。接着在虚拟机中指派一个固定地址，网关和DNS填上面宿主机的IP地址，子网掩码保持一致，IP地址建议就用现在指派的IP地址。<br><img src="/../../images/e9b13a6df8bbefc3b56594a02c4ce0d7.png" alt="e9b13a6df8bbefc3b56594a02c4ce0d7.png"></p>
<p>设置完成后ping一下google的DNS看看是否能正常联网：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 8.8.8.8</span><br></pre></td></tr></table></figure>

<h3 id="4-2-虚拟机开启远程桌面"><a href="#4-2-虚拟机开启远程桌面" class="headerlink" title="4.2 虚拟机开启远程桌面"></a>4.2 虚拟机开启远程桌面</h3><p>Ubuntu提供了图形界面配置远程桌面，这里不作介绍了。下面是通过命令行配置RPD远程桌面的内容。<br>安装第三方软件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install xrdp</span><br></pre></td></tr></table></figure>

<p>启用 XRDP 服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> xrdp</span><br><span class="line"><span class="built_in">sudo</span> systemctl start xrdp</span><br></pre></td></tr></table></figure>

<p>检查服务状态：<br>启用 XRDP 服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl sattus xrdp</span><br></pre></td></tr></table></figure>

<h3 id="4-3-检查虚拟机防火墙状态"><a href="#4-3-检查虚拟机防火墙状态" class="headerlink" title="4.3 检查虚拟机防火墙状态"></a>4.3 检查虚拟机防火墙状态</h3><p> Ubuntu 通常是 ufw(Uncomplicated Firewall)，以下命令检查系统上的防火墙是否已启用并显示其当前配置。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ufw status</span><br></pre></td></tr></table></figure>
<p>如果防火墙尚未启用，以下命令启用防火墙：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ufw <span class="built_in">enable</span></span><br></pre></td></tr></table></figure>

<p>以下命令在防火墙中打开3389端口：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ufw allow from any to any port 3389 proto tcp</span><br></pre></td></tr></table></figure>

<p>这时候我们就可以通过远程桌面，而不是虚拟机的小窗口连接Ubuntu虚拟机了。<br>提示：Ubuntu需要先在虚拟机窗口中注销用户，才能使用远程连接，否则会出现黑屏、闪退的问题。不知道这个bug何时能修复。</p>
<h2 id="5-开启虚拟机相关服务"><a href="#5-开启虚拟机相关服务" class="headerlink" title="5. 开启虚拟机相关服务"></a>5. 开启虚拟机相关服务</h2><h3 id="5-1-虚拟机开启SSH服务"><a href="#5-1-虚拟机开启SSH服务" class="headerlink" title="5.1 虚拟机开启SSH服务"></a>5.1 虚拟机开启SSH服务</h3><p>安装 OpenSSH ：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install openssh-server</span><br></pre></td></tr></table></figure>

<p>检查 SSH 服务器状态：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status ssh</span><br></pre></td></tr></table></figure>
<p>如果输出显示<code>Active: active (running)</code>，表示 SSH 服务器正在运行。</p>
<p>如果ssh服务显示<code>Active: inactive (dead)</code>，通过以下命令开启ssh服务：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl enable ssh</span><br><span class="line">sudo systemctl start ssh</span><br></pre></td></tr></table></figure>

<p>OpenSSH服务器的配置文件默认位于<code>/etc/ssh/sshd_config</code>。用户可以根据需要修此配置文件来更改相关配置，例如监听端口、允许或禁止密码登录、限制登录用户等。</p>
<h3 id="5-2-虚拟机添加防火墙规则"><a href="#5-2-虚拟机添加防火墙规则" class="headerlink" title="5.2 虚拟机添加防火墙规则"></a>5.2 虚拟机添加防火墙规则</h3><p>以下命令在防火墙中添加 SSH 规则：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ufw allow OpenSSH</span><br></pre></td></tr></table></figure>

<p>以下状态显示防火墙配置成功：<br><img src="/../../images/6180d2d720503ee25c376fd84c4b3954.png" alt="6180d2d720503ee25c376fd84c4b3954.png"></p>
<h3 id="5-3-测试SSH连接"><a href="#5-3-测试SSH连接" class="headerlink" title="5.3 测试SSH连接"></a>5.3 测试SSH连接</h3><p>Ubuntu虚拟机的IP地址可以在Hyper-V管理器的窗口中查看，也可以在虚拟机中通过以下命令获取：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ip addr show | grep inet</span><br><span class="line">ip a | grep inet	<span class="comment">#这两条命令效果一样</span></span><br></pre></td></tr></table></figure>

<p>使用bash或powershell客户端，通过以下命令连接到服务器，将<code>username</code>和<code>ip_address</code>分别替换为虚拟机的用户名和IP地址即可，会提示输入密码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh username@ip_address</span><br></pre></td></tr></table></figure>

<h3 id="5-4-测试SFTP连接"><a href="#5-4-测试SFTP连接" class="headerlink" title="5.4 测试SFTP连接"></a>5.4 测试SFTP连接</h3><p>启用ssh之后会默认开通sftp，端口号和ssh一样都是22，通过以下命令连接sftp，根据提示输入密码即可登录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sftp username@ip_address</span><br></pre></td></tr></table></figure>

<p>上传文件<code>put</code>：  把本地服务器的<code>D:\temp\test</code>目录下面的<code>test.txt</code>文件上传到远程服务器的<code>/home/username/test</code>目录下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sftp&gt; lcd D:/temp/test</span><br><span class="line">sftp&gt; cd /home/username/test</span><br><span class="line">sftp&gt; put test.txt </span><br></pre></td></tr></table></figure>

<p>上传文件夹<code>put</code>：把本地服务器的<code>D:\temp\test</code>目录下面的<code>logs</code>文件夹上传到远程服务器的<code>/home/username/test</code>目录下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sftp&gt; lcd D:/temp/test</span><br><span class="line">sftp&gt; cd /home/username/test</span><br><span class="line">sftp&gt; put -r logs</span><br></pre></td></tr></table></figure>

<p>下载命令：<code>get</code>，用法与put类似。<br>sftp常用命令可以通过<code>help</code>查看。建议通过第三方工具，比如<code>FileZilla</code>来登录操作。</p>
<h2 id="6-端口映射"><a href="#6-端口映射" class="headerlink" title="6. 端口映射"></a>6. 端口映射</h2><h3 id="6-1-宿主机端口映射"><a href="#6-1-宿主机端口映射" class="headerlink" title="6.1 宿主机端口映射"></a>6.1 宿主机端口映射</h3><p>首先要查看宿主机的端口占用情况。在<code>PowerShell</code>或<code>CMD</code>中通过以下命令查看：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netstat <span class="literal">-ano</span> <span class="comment">#查看所有端口</span></span><br><span class="line">netstat <span class="literal">-ano</span> | findstr <span class="number">8022</span> <span class="comment">#8022为查询的端口号</span></span><br><span class="line">tasklist | findstr <span class="number">5748</span> <span class="comment">#5748指的是8022端口对应的pid，查看占用该端口的程序</span></span><br></pre></td></tr></table></figure>

<p>宿主机中用管理员权限打开<code>PowerShell</code>或<code>CMD</code>窗口，通过以下命令查询、添加、删除端口映射。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询端口映射</span></span><br><span class="line">netsh interface portproxy show v4tov4</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 查询指定IP端口映射</span></span><br><span class="line">netsh interface portproxy show v4tov4|findstr <span class="string">&quot;192.168.100.135&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&lt;# 增加一个端口映射</span></span><br><span class="line"><span class="comment">netsh interface portproxy add v4tov4 listenport=宿主机端口 listenaddress=宿主机IP connectaddress=虚拟机IP connectport=虚拟机端口</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 通过宿主机8022端口映射虚拟机22端口，访问SSH</span></span><br><span class="line">netsh interface portproxy add v4tov4 listenport=<span class="number">8022</span> listenaddress=<span class="number">192.168</span>.<span class="number">100.135</span> connectaddress=<span class="number">172.25</span>.<span class="number">68.88</span> connectport=<span class="number">22</span></span><br><span class="line"><span class="comment"># 通过宿主机63389、63390端口映射虚拟机3389、3390端口，访问远程桌面</span></span><br><span class="line"><span class="comment"># 端口号范围：1-65535，不能超出该范围</span></span><br><span class="line">netsh interface portproxy add v4tov4 listenport=<span class="number">63389</span> listenaddress=<span class="number">192.168</span>.<span class="number">100.135</span> connectaddress=<span class="number">172.25</span>.<span class="number">68.88</span> connectport=<span class="number">3389</span></span><br><span class="line">netsh interface portproxy add v4tov4 listenport=<span class="number">63390</span> listenaddress=<span class="number">192.168</span>.<span class="number">100.135</span> connectaddress=<span class="number">172.25</span>.<span class="number">68.88</span> connectport=<span class="number">3390</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">&lt;# 删除一个端口映射</span></span><br><span class="line"><span class="comment">netsh interface portproxy delete v4tov4 listenaddress=宿主机IP listenport=宿主机端口</span></span><br><span class="line"><span class="comment">#&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 删除上面定义的端口映射</span></span><br><span class="line">netsh interface portproxy delete v4tov4  listenaddress=<span class="number">192.168</span>.<span class="number">100.135</span> listenport=<span class="number">8022</span></span><br><span class="line">netsh interface portproxy delete v4tov4  listenaddress=<span class="number">192.168</span>.<span class="number">100.135</span> listenport=<span class="number">63389</span></span><br><span class="line">netsh interface portproxy delete v4tov4  listenaddress=<span class="number">192.168</span>.<span class="number">100.135</span> listenport=<span class="number">63390</span></span><br></pre></td></tr></table></figure>

<p>配置好端口映射后，就可以在远程桌面中通过访问<code>IP地址:端口号</code>的形式连接到虚拟机桌面了。</p>
<h3 id="6-2-宿主机防火墙设置"><a href="#6-2-宿主机防火墙设置" class="headerlink" title="6.2 宿主机防火墙设置"></a>6.2 宿主机防火墙设置</h3><p>宿主机防火墙要开放端口，这样才能通过外网访问。首先打开<code>Windows Defender防火墙</code>，在<code>高级设置</code>里面新建入站规则。<br><img src="/../../images/f005bc29f02fae09166378349dac9e9d.png" alt="f005bc29f02fae09166378349dac9e9d.png"><br>规则类型选择端口，端口号输入上面映射的端口(用英文半角逗号隔开)，后面全部确认即可。</p>
<p>到此为止，终于实现外网用户通过宿主机的IP地址+端口号的形式访问该虚拟机了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Linux/Hyper-V%E5%AE%89%E8%A3%85Ubuntu24.04/" data-id="cm8orjgqh0009pw090oj7hcrs" data-title="Hyper-V安装Ubuntu24.04" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CFD/PowerShell编写STAR-CCM+自动排队计算脚本" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/CFD/PowerShell%E7%BC%96%E5%86%99STAR-CCM+%E8%87%AA%E5%8A%A8%E6%8E%92%E9%98%9F%E8%AE%A1%E7%AE%97%E8%84%9A%E6%9C%AC/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:23.618Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/CFD/PowerShell%E7%BC%96%E5%86%99STAR-CCM+%E8%87%AA%E5%8A%A8%E6%8E%92%E9%98%9F%E8%AE%A1%E7%AE%97%E8%84%9A%E6%9C%AC/">PowerShell编写STAR-CCM+自动排队计算脚本</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>25&#x2F;03&#x2F;2025</p>
<hr>
<p>以前用STAR-CCM+在Windows工作站做计算的时候（没钱，公司舍不得上超算……），有时候一晚上要提交十几二十个计算任务（瞎卷ㄟ( ▔, ▔ )ㄏ），当然不可能十几个任务全都一起跑（机器遭不住），也不可能全程盯着它跑一个个手动提交（人遭不住）。几年前用PowerShell编写了这个简易的排队计算的模板，在这里分享给大家。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$title</span> = <span class="string">&quot;STAR-CCM+ 19.06.009-r8&quot;</span>	<span class="comment"># 窗口标题，怎么填随你喜欢</span></span><br><span class="line"><span class="variable">$host</span>.ui.RawUI.WindowTitle = <span class="variable">$title</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$STARCCM_PATH</span> = <span class="string">&quot;D:\XXX\Siemens\19.06.009-R8\STAR-CCM+19.06.009-R8\star\lib\win64\clang17.0vc14.2-r8\lib&quot;</span>	<span class="comment"># 填写本机STAR-CCM+的安装绝对路径</span></span><br><span class="line"><span class="variable">$env:path</span> += <span class="string">&quot;;<span class="variable">$STARCCM_PATH</span>&quot;</span></span><br><span class="line"><span class="variable">$run_dir</span> = <span class="variable">$pwd</span></span><br><span class="line"><span class="variable">$thread_number</span> = <span class="number">32</span>	<span class="comment"># 填写本机的CPU核心数</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$Array</span> = <span class="built_in">Get-ChildItem</span> <span class="literal">-Path</span> <span class="variable">$run_dir</span> <span class="literal">-Name</span> <span class="string">&quot;*.sim&quot;</span></span><br><span class="line"><span class="variable">$n</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$item</span> <span class="keyword">in</span> <span class="variable">$Array</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$n</span> += <span class="number">1</span></span><br><span class="line">    <span class="variable">$sub_dir</span> = <span class="variable">$n</span>.ToString() + <span class="string">&quot;_&quot;</span> + <span class="variable">$item</span>.Substring(<span class="number">0</span>,<span class="variable">$item</span>.Length<span class="literal">-4</span>)</span><br><span class="line">    mkdir <span class="variable">$sub_dir</span></span><br><span class="line">    <span class="built_in">mv</span> <span class="variable">$item</span> <span class="variable">$sub_dir</span></span><br><span class="line">    <span class="built_in">cd</span> <span class="variable">$sub_dir</span></span><br><span class="line">    <span class="variable">$host</span>.ui.RawUI.WindowTitle = <span class="variable">$title</span> + <span class="string">&quot; - &quot;</span> + <span class="variable">$item</span> + <span class="string">&quot; - &quot;</span> + <span class="variable">$n</span> + <span class="string">&quot;/&quot;</span> + <span class="variable">$Array</span>.Count</span><br><span class="line">    <span class="variable">$log</span> = <span class="variable">$item</span> + <span class="string">&quot;.log&quot;</span></span><br><span class="line">    starccm+ <span class="variable">$item</span> <span class="literal">-batch</span> run <span class="literal">-np</span> <span class="variable">$thread_number</span> <span class="literal">-mpi</span> ms | <span class="built_in">tee</span> <span class="variable">$log</span></span><br><span class="line">    <span class="built_in">cd</span> <span class="variable">$run_dir</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>把以上命令行以文本格式保存为<code>.ps1</code>脚本文件，和要提交计算的<code>.sim</code>文件放到同一个文件夹，然后通过终端运行这个脚本。会自动统计排队任务数，将计算的.sim文件转移至新建子文件夹，同时生成<code>.log</code>日志文件，也可以在输出窗口中监控运行情况。计算完成后关闭终端即可。</p>
<p>美中不足的是，不支持宏文件，也不支持临时增加或插入算例。</p>
<p>各位可以针对自己的情况，做一些针对性的调整。</p>
<p>如果碰到输出窗口和日志文件中有乱码的情况，多半是你的PowerShell不支持UTF-8所导致。参考以下方法<a href="%5BWindowsPowerShell%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%5D(https://www.azfum.com/archives/ki3syg5b/)">^1</a>，在PowerShell窗口中输入：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置文件一般位于：C:\Users\用户名\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</span></span><br><span class="line"><span class="comment"># 如果没有就新建一个</span></span><br><span class="line">notepad <span class="variable">$PROFILE</span> <span class="comment"># 编辑配置文件</span></span><br></pre></td></tr></table></figure>

<p>在配置文件中增加以下内容，保存退出：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$OutputEncoding</span> = [<span class="type">console</span>]::InputEncoding = [<span class="type">console</span>]::OutputEncoding = [<span class="type">Text.UTF8Encoding</span>]::UTF8</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/CFD/PowerShell%E7%BC%96%E5%86%99STAR-CCM+%E8%87%AA%E5%8A%A8%E6%8E%92%E9%98%9F%E8%AE%A1%E7%AE%97%E8%84%9A%E6%9C%AC/" data-id="cm8orjgqg0008pw09fxek4dah" data-title="PowerShell编写STAR-CCM+自动排队计算脚本" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Ansa/Ansa薄板网格建模" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Ansa/Ansa%E8%96%84%E6%9D%BF%E7%BD%91%E6%A0%BC%E5%BB%BA%E6%A8%A1/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:19.233Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Ansa/Ansa%E8%96%84%E6%9D%BF%E7%BD%91%E6%A0%BC%E5%BB%BA%E6%A8%A1/">Ansa薄板网格建模</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>18&#x2F;03&#x2F;2025</p>
<hr>
<p>由于近期经常做一些冷板结构分析，涉及到薄板建模的。虽然尝试过用Shell单元进行分析，但相比于Solid单元，Shell单元做出来的结果应力、位移均有所偏大，而且涉及到接触问题更容易出现计算不收敛的情况。<br>所幸Ansa提供了通过Shell单元拉伸生成体网格的方式，可以快速通过Shell单元生成Solid网格，极大地节省了建模时间。</p>
<p>建模步骤如下：</p>
<ol>
<li><p>薄板实体简化为Shell并划分网格，可以参考<a href="../Ansa/Ansa%E6%8A%BD%E4%B8%AD%E9%9D%A2%E5%8A%9F%E8%83%BD.md">Ansa抽中面功能</a>。<br><img src="/../../images/5c6da744441c0b43367e9d1ff0296ec1.png" alt="5c6da744441c0b43367e9d1ff0296ec1.png"></p>
</li>
<li><p><code>Volume Mesh</code>→<code>Extrude</code>调出<code>Extrude</code>窗口，选中要拉伸的Shell单元。<br><img src="/../../images/02fe91f7f3a74047ccd442f4eaa42505.png" alt="02fe91f7f3a74047ccd442f4eaa42505.png"></p>
</li>
<li><p>目标面选择<code>None</code>。<br><img src="/../../images/5818d8ffc832684765e7312eafe76ea9.png" alt="5818d8ffc832684765e7312eafe76ea9.png"></p>
</li>
<li><p>拉伸方式选择<code>Offse</code>t，方向选择<code>Both sides (middle)</code>。<br><img src="/../../images/d464570c23719e82fcd4d152a9278f8d.png" alt="d464570c23719e82fcd4d152a9278f8d.png"></p>
</li>
<li><p><code>Steps</code>选择层数，<code>Distance</code>输入薄板厚度，<code>Biasing</code>建议选择<code>Smooth</code>，<code>Finish</code>完成。<br><img src="/../../images/e3b90aaa49545a963c3f998a86a3a036.png" alt="e3b90aaa49545a963c3f998a86a3a036.png"></p>
</li>
<li><p>检查生成的网格质量，修复差网格。<br><img src="/../../images/242f974310b6eff9061c0c8ce2230673.png" alt="242f974310b6eff9061c0c8ce2230673.png"></p>
</li>
</ol>
<p>总结：这种方式比较适合厚度均匀的薄板生成体网格。但是当薄板厚度不均匀，或者存在T型连接（例如注塑件筋条等，如下图）的时候，就不适用了。<br><img src="/../../images/0ad79055f8a7a324c278b023ee79be6f.png" alt="0ad79055f8a7a324c278b023ee79be6f.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Ansa/Ansa%E8%96%84%E6%9D%BF%E7%BD%91%E6%A0%BC%E5%BB%BA%E6%A8%A1/" data-id="cm8orjgqg0007pw093bmq1k08" data-title="Ansa薄板网格建模" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Ansa/Abaqus接触设置" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/03/26/Ansa/Abaqus%E6%8E%A5%E8%A7%A6%E8%AE%BE%E7%BD%AE/" class="article-date">
  <time class="dt-published" datetime="2025-03-25T17:27:19.228Z" itemprop="datePublished">2025-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/03/26/Ansa/Abaqus%E6%8E%A5%E8%A7%A6%E8%AE%BE%E7%BD%AE/">Abaqus接触设置</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>10&#x2F;03&#x2F;2025</p>
<hr>
<p>[TOC]</p>
<hr>
<h2 id="1-相关命令"><a href="#1-相关命令" class="headerlink" title="1. 相关命令"></a>1. 相关命令</h2><p>Ansa中，给Abaqus设置接触一般常用以下命令：<br><img src="/../../images/cb35dcf11a636abacef3aabe97112e62.png" alt="cb35dcf11a636abacef3aabe97112e62.png"></p>
<h2 id="2-接触对"><a href="#2-接触对" class="headerlink" title="2. 接触对"></a>2. 接触对</h2><p>最常用的接触对，一般通过<code>AUXILIARIES</code>→ <code>CONTACT</code>→<code>CONTACT</code>调出创建对话框。<br><img src="/../../images/038dffae1f80e68c064572e228df00c6.png" alt="038dffae1f80e68c064572e228df00c6.png"><br>常用设置一般为以下几个：</p>
<ol>
<li>定义接触名称，方便检索</li>
<li>定义接触类型为<code>接触对</code>(<code>CONTACT PAIR</code>)或者<code>通用接触</code>(<code>CONTACT INCLUSIONS</code>或<code>CONTACT EXCLUSIONS</code>)</li>
<li>接触从面，需要预先在<code>SET</code>里设置好单元集合</li>
<li>接触主面，需要预先在<code>SET</code>里设置好单元集合</li>
<li>接触行为，定义摩擦系数等</li>
<li>接触面调整行为，选择<code>YES</code>可以在后面的<code>POS_TOLER</code>定义容差数值</li>
<li>接触面是否产生小滑移，默认<code>NO</code></li>
<li>接触类型，默认<code>surface-to-surface</code>，或者<code>node-to-surface</code></li>
<li>接触间隙，定义接触的过盈或间隙值</li>
</ol>
<h2 id="3-通用接触"><a href="#3-通用接触" class="headerlink" title="3. 通用接触"></a>3. 通用接触</h2><p>跟创建接触对共用同一个命令和对话框，只需要把接触类型改为<code>接触包含面</code>(<code>CONTACT INCLUSIONS</code>)或<code>接触排除面</code>(<code>CONTACT EXCLUSIONS</code>)即可。<br><img src="/../../images/5ce0bee8d0eaf02a8ec041bb8aa5d791.png" alt="5ce0bee8d0eaf02a8ec041bb8aa5d791.png"></p>
<ol>
<li>定义接触类型</li>
<li>接触从面，选择<code>SET</code>里设置好的单元集合</li>
<li>接触主面，选择<code>SET</code>里设置好的单元集合（一般不需要，可以留空）</li>
<li>接触行为</li>
</ol>
<h2 id="4-绑定接触"><a href="#4-绑定接触" class="headerlink" title="4. 绑定接触"></a>4. 绑定接触</h2><p>通过<code>AUXILIARIES</code>→ <code>CONTACT</code>→<code>TIE</code>调出对话框。<br><img src="/../../images/e354721ca85e003b8683798b2a78cde3.png" alt="e354721ca85e003b8683798b2a78cde3.png"></p>
<ol>
<li>接触从面，选择<code>SET</code>里设置好的单元集合</li>
<li>接触主面，选择<code>SET</code>里设置好的单元集合</li>
<li>当两个接触面存在不重合时，可以在这里设置接触容差</li>
</ol>
<h2 id="5-接触向导"><a href="#5-接触向导" class="headerlink" title="5.接触向导"></a>5.接触向导</h2><p>Ansa内置的功能，可以通过引导建立接触。通过<code>AUXILIARIES</code>→ <code>CONTACT</code>→<code>Assistant</code>命令调出。<br><img src="/../../images/305cb5999a3ca4c8cffc347b22e893d9.png" alt="305cb5999a3ca4c8cffc347b22e893d9.png"></p>
<h2 id="6-自动创建接触对"><a href="#6-自动创建接触对" class="headerlink" title="6. 自动创建接触对"></a>6. 自动创建接触对</h2><p>通过<code>AUXILIARIES</code>→ <code>CONTACT</code>→<code>Flanges</code>调出。<br><img src="/../../images/7d0af046869e917327ec96591dfd5c6a.png" alt="7d0af046869e917327ec96591dfd5c6a.png"></p>
<ol>
<li>选择要搜索的对象</li>
<li>定义搜索距离容差</li>
</ol>
<p>在弹出对话框里面检查、定义接触参数。<br><img src="/../../images/7727dd9b9786726aa43e70e2e4891cee.png" alt="7727dd9b9786726aa43e70e2e4891cee.png"></p>
<h2 id="7-与接触有关的输出设置"><a href="#7-与接触有关的输出设置" class="headerlink" title="7. 与接触有关的输出设置"></a>7. 与接触有关的输出设置</h2><p>一般在<code>STEP</code>的<code>OUTPUT</code>选项卡里面定义，没有特殊要求的话输出参数选择<code>PRESELECT</code>就行了。<br><img src="/../../images/6ce6c753db7bf01666dfe10178b59a0b.png" alt="6ce6c753db7bf01666dfe10178b59a0b.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/03/26/Ansa/Abaqus%E6%8E%A5%E8%A7%A6%E8%AE%BE%E7%BD%AE/" data-id="cm8orjgq80000pw094brfdp2i" data-title="Abaqus接触设置" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">三月 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/03/26/Linux/Ubuntu24.04%E5%AE%89%E8%A3%85Ansys2025R1/">Ubuntu24.04安装Ansys2025R1</a>
          </li>
        
          <li>
            <a href="/2025/03/26/Linux/Ubuntu24.04%E6%90%AD%E5%BB%BASamba%E6%9C%8D%E5%8A%A1%E5%99%A8/">Ubuntu24.04搭建Samba服务器</a>
          </li>
        
          <li>
            <a href="/2025/03/26/Linux/Ubuntu%E5%AE%89%E8%A3%85SIMULIA2024/">Ubuntu安装SIMULIA2024</a>
          </li>
        
          <li>
            <a href="/2025/03/26/Linux/Hyper-V%E8%99%9A%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BANAT%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP/">Hyper-V虚拟交换机NAT设置静态IP</a>
          </li>
        
          <li>
            <a href="/2025/03/26/Linux/Ubuntu%E5%AE%89%E8%A3%85Slurm/">Ubuntu安装Slurm</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Andrew Moa<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>